<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Ermittlungszentrale | Tag 9 â€“ Die Gruppe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      background-color: #f1ebe0;
      font-family: "Courier New", monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }

    .chat-container {
      background: rgba(20, 20, 20, 0.95);
      color: #fff;
      width: 92%;
      max-width: 650px;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .chat-box {
      min-height: 340px;
      overflow-y: auto;
    }

    .msg {
      margin: 8px 0;
      padding: 10px;
      border-radius: 10px;
      max-width: 90%;
    }

    .bot { background: #2d2d2d; }
    .user { background: #004c97; align-self: flex-end; }

    .choices {
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    button {
      padding: 10px;
      background: #004c97;
      border: none;
      border-radius: 6px;
      color: white;
      font-size: 15px;
      cursor: pointer;
    }

    button:hover { background: #0073e6; }

    a {
      color: #00ffcc;
      font-weight: bold;
      text-decoration: none;
      margin-top: 15px;
      display: inline-block;
    }
  </style>
</head>

<body>

<div class="chat-container">
  <div id="chat" class="chat-box"></div>
  <div id="choices" class="choices"></div>
</div>

<script>
const chat = document.getElementById("chat");
const choices = document.getElementById("choices");

// âœ… SHUFFLE-FUNKTION â€“ AB JETZT STANDARD FÃœR ALLE SPIELE
function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function msg(text, type="bot") {
  const div = document.createElement("div");
  div.className = "msg " + type;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function clearChoices() {
  choices.innerHTML = "";
}

function gameOver() {
  clearChoices();
  msg("âŒ Diese Entscheidung bringt Sie keinen Schritt weiter.");
  const btn = document.createElement("button");
  btn.textContent = "ðŸ” Analyse neu beginnen";
  btn.onclick = () => location.reload();
  choices.appendChild(btn);
}

function ask(text, options) {
  msg(text);
  clearChoices();
  shuffle(options).forEach(o => {   // âœ… AUTOMATISCHES MISCHEN
    const b = document.createElement("button");
    b.textContent = o.text;
    b.onclick = () => {
      msg("ðŸ•µï¸ " + o.text, "user");
      if (o.correct) {
        if (o.reply) msg(o.reply);
        o.next();
      } else {
        gameOver();
      }
    };
    choices.appendChild(b);
  });
}

// ---------------- START ----------------

msg("ðŸ§© Ermittlungszentrale, 03:12 Uhr.");
msg("ðŸ•µï¸ Frost: Zwei Spuren. Zwei verschiedene Hinweisarten. Und ein zerstÃ¶rtes Auto.");
msg("ðŸ•µï¸ Analyst: Das war kein EinzeltÃ¤ter. Das war koordiniert.");
step1();

// ---------------- SCHRITTE ----------------

function step1() {
  ask("1ï¸âƒ£ Was analysieren Sie zuerst?", [
    { text: "Den angebissenen Keks.", correct:true, reply:"ðŸ§ª Speichelanalyse lÃ¤uft.", next: step2 },
    { text: "Die Farbe des Autos.", correct:false },
    { text: "Die SitzbezÃ¼ge.", correct:false }
  ]);
}

function step2() {
  ask("2ï¸âƒ£ Das Ergebnis kommt rein:", [
    { text: "Die DNA gehÃ¶rt zu einer unbekannten Frau.", correct:true, reply:"ðŸ§¬ Treffer bestÃ¤tigt.", next: step3 },
    { text: "Die DNA gehÃ¶rt dem Opfer.", correct:false },
    { text: "Keine DNA vorhanden.", correct:false }
  ]);
}

function step3() {
  ask("3ï¸âƒ£ Welche zweite Spur ist entscheidend?", [
    { text: "Die gerauchte Zigarette.", correct:true, reply:"ðŸš¬ Nikotin + Fremd-DNA eindeutig.", next: step4 },
    { text: "Der AuÃŸenspiegel.", correct:false },
    { text: "Die Autoradio-Frequenz.", correct:false }
  ]);
}

function step4() {
  ask("4ï¸âƒ£ Was lÃ¤sst sich daraus schlieÃŸen?", [
    { text: "Mindestens zwei TÃ¤ter waren vor Ort.", correct:true, reply:"ðŸ‘¥ Gruppenbeteiligung bestÃ¤tigt.", next: step5 },
    { text: "Das Opfer war allein.", correct:false },
    { text: "Der Fall war ein Unfall.", correct:false }
  ]);
}

function step5() {
  ask("5ï¸âƒ£ Welche weitere Spur stÃ¼tzt diese Annahme?", [
    { text: "Zwei verschiedene SchuhabdrÃ¼cke am Auto.", correct:true, reply:"ðŸ‘Ÿ Zwei unterschiedliche Profile.", next: step6 },
    { text: "Eine zerbrochene Flasche.", correct:false },
    { text: "Ein offenes Fenster.", correct:false }
  ]);
}

function step6() {
  ask("6ï¸âƒ£ Was bedeutet das fÃ¼r den Weihnachtsmann-Fall?", [
    { text: "Der TÃ¤ter hatte Helfer.", correct:true, reply:"ðŸ”— Verbrechen vernetzt.", next: step7 },
    { text: "Es war eine Kurzschlusshandlung.", correct:false },
    { text: "Der TÃ¤ter handelte spontan.", correct:false }
  ]);
}

// âœ… AB HIER JETZT ENDGÃœLTIG IRREFÃœHREND & OFFEN â€“ KEINE AUFLÃ–SUNG MEHR

function step7() {
  ask("7ï¸âƒ£ Welche Rolle spielt die unbekannte Frau jetzt?", [
    { text: "Sie bewegt sich innerhalb des TÃ¤terumfelds.", correct:true, reply:"ðŸ§© Ihre Rolle bleibt unklar.", next: step8 },
    { text: "Sie war zufÃ¤llig vor Ort.", correct:false },
    { text: "Sie wird ausgeschlossen.", correct:false }
  ]);
}

function step8() {
  ask("8ï¸âƒ£ Was bedeutet ihre doppelte Spur fÃ¼r die Ermittlungen?", [
    { text: "Sie taucht in mehreren ZusammenhÃ¤ngen auf.", correct:true, reply:"ðŸ“ Mehrere Tatorte â€“ gleiche Verbindung.", next: step9 },
    { text: "Die Spur verliert an Bedeutung.", correct:false },
    { text: "Sie kann ignoriert werden.", correct:false }
  ]);
}

function step9() {
  ask("9ï¸âƒ£ Welche neue Gefahr ergibt sich daraus?", [
    { text: "Die Strukturen hinter dem TÃ¤ter sind grÃ¶ÃŸer als gedacht.", correct:true, reply:"âš  Die Dimension verÃ¤ndert sich.", next: finish },
    { text: "Die Gruppe lÃ¶st sich auf.", correct:false },
    { text: "Es folgt keine weitere Tat.", correct:false }
  ]);
}

// ---------------- ABSCHLUSS ----------------

function finish() {
  clearChoices();
  msg("ðŸ•µï¸ Frost: Das hier ist grÃ¶ÃŸer als nur ein einzelner TÃ¤ter.");
  msg("ðŸ•µï¸ Analyst: Und wir kennen das Ende noch nicht.");
  msg("ðŸ“‚ TAG 9 ABGESCHLOSSEN â€“ Die Strukturen im Hintergrund verdichten sich.");

  const link = document.createElement("a");
  link.href = "../akte.html";
  link.textContent = ">> Zur Akte <<";
  choices.appendChild(link);
}
</script>

</body>
</html>
